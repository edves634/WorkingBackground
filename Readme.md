# Приложение для работы с фоновыми задачами на Android

## Обзор приложения

Это Android-приложение демонстрирует две ключевые возможности работы с фоновыми задачами:
1. **Связанный сервис (Bound Service)** - позволяет компонентам приложения взаимодействовать с сервисом
2. **Загрузка файлов** - использует системный DownloadManager для загрузки MP3 файлов

Приложение имеет простой интерфейс с тремя кнопками для управления сервисом и загрузкой файлов.

## Основные функции

### 1. Работа со связанным сервисом (Bound Service)

- **Start Service**: Привязывает активность к сервису и вызывает его метод `startService()`
- **Stop Service**: Вызывает метод `stopService()` и отвязывает активность от сервиса
- Логирование всех событий в Logcat с тегом "MyBoundService"

### 2. Загрузка MP3 файлов

- **Download MP3**: Запускает загрузку MP3 файла по указанному URL
- Использует системный DownloadManager для фоновой загрузки
- Сохраняет файлы в папку Downloads устройства
- Показывает уведомление о ходе загрузки
- Запрашивает разрешение на запись в хранилище при необходимости

## Техническая реализация

### Ключевые компоненты

1. **MainActivity.kt** - основная активность приложения:
    - Управляет UI с тремя кнопками
    - Обрабатывает привязку/отвязку от сервиса
    - Управляет разрешениями и загрузкой файлов
    - Использует ServiceConnection для связи с сервисом

2. **MyBoundService.kt** - сервис для демонстрации привязки:
    - Реализует Binder для взаимодействия с активностью
    - Предоставляет методы startService() и stopService()
    - Логирует ключевые события жизненного цикла

3. **AndroidManifest.xml**:
    - Объявляет сервис и разрешения
    - Разрешения: INTERNET и WRITE_EXTERNAL_STORAGE
    - Для Android 10+ добавлен атрибут `android:requestLegacyExternalStorage="true"`

### Особенности реализации

- **Динамические разрешения**: Для Android 6.0+ реализован запрос разрешений в runtime
- **Жизненный цикл**: Корректная обработка привязки/отвязки сервиса при смене конфигурации
- **Системный DownloadManager**: Используется для надежной фоновой загрузки
- **Логирование**: Подробное логирование всех операций для отладки


## Требования

- Android 5.0 (API 21) и выше
- Разрешение на доступ к интернету
- Разрешение на запись во внешнее хранилище

## Важные замечания

1. Для Android 10+ в манифесте добавлен флаг `requestLegacyExternalStorage`
2. Для Android 11+ может потребоваться дополнительная обработка разрешений
3. Для тестирования замените URL в коде на актуальную ссылку на MP3 файл


